function init_data(){var t=moment().startOf("month"),e=t.daysInMonth();return create_data(t,e)}function create_data(t,e){for(var a=0,n=[];e>a;a++)d=[],d.push(t.format("MM/DD (ddd)")),t.add(1,"day"),n.push(d);return n}function change_date(){var t=moment();t.set("year",$("#year").val()),t.set("month",$("#month").val()),data=create_data(t.startOf("month"),t.startOf("month").daysInMonth()),grid.loadData(data)}var data=init_data(),platform_editor={};!function(){"use strict";var t=document.getElementById("platform_result");platform_editor.setText=function(){var e="";$.each(data,function(t,a){var n=moment($("#year").val()+"/"+a[0],"YYYY/MM/DD (dd)");$.each(["start_time","end_time","relax_time"],function(t,o){null!=a[t+1]&&(e+="$('#"+n.format("YYYYMMDD")+o+"').val('"+a[t+1]+"').trigger('focusout');\n")}),null!=a[4]&&(e+="$('#DailyReport"+n.format("YYYYMMDD")+"WorkContent').val('"+a[4]+"');\n")}),t.innerHTML=e},$("#platform_result").click(function(){var t=document.createRange(),e=window.getSelection();t.selectNodeContents(this),e.removeAllRanges(),e.addRange(t)})}();var grid={};!function(){"use strict";var t=document.getElementById("grid"),e=(document.getElementById("year"),document.getElementById("month"),function(){for(var t=moment().startOf("day"),e=0,a=96,n=15,o=[];a>e;e++)o.push(t.format("HH:mm")),t.add(n,"minute");return o});grid=new Handsontable(t,{data:data,colHeaders:["　日付　","　開始　","　終了　","　休憩　","　作業内容　"],columns:[{readOnly:!0},{type:"dropdown",source:e()},{type:"dropdown",source:e()},{type:"dropdown",source:e()},{}],afterRender:function(t,e){platform_editor.setText()},afterCreateRow:function(t,e){data.splice(t,e)}}),function(){$("#year").val(moment().get("year")).change(function(){change_date()}),$("#month").val(moment().get("month")).change(function(){change_date()})}()}();